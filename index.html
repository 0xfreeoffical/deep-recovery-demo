<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<title>Aura</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#000;font-family:Georgia,'Times New Roman',serif}
canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1}
#ui{position:fixed;top:0;left:0;width:100%;height:100%;z-index:2;pointer-events:none;display:flex;flex-direction:column;align-items:center}
#topLabel{position:absolute;top:max(12vh,60px);font-family:-apple-system,Helvetica,Arial,sans-serif;font-size:10px;letter-spacing:.4em;color:#555;text-transform:uppercase}
#title{position:absolute;top:calc(max(12vh,60px) + 28px);font-size:44px;color:#fff;font-weight:300;opacity:.9}
#recal{position:absolute;top:50%;left:50%;transform:translate(-50%,80px);font-family:-apple-system,Helvetica,Arial,sans-serif;font-size:9px;letter-spacing:.35em;color:rgba(255,255,255,.15);text-transform:uppercase;transition:opacity .8s}
#btn{position:absolute;bottom:max(8vh,40px);pointer-events:all;background:rgba(255,255,255,.08);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.15);border-radius:40px;padding:14px 36px;color:#fff;font-family:-apple-system,Helvetica,Arial,sans-serif;font-size:11px;letter-spacing:.3em;cursor:pointer;transition:background .3s,border-color .3s;user-select:none;-webkit-tap-highlight-color:transparent}
#btn:active{background:rgba(255,255,255,.15)}
#status{position:absolute;bottom:calc(max(8vh,40px) - 28px);font-family:-apple-system,Helvetica,Arial,sans-serif;font-size:9px;letter-spacing:.15em;color:rgba(255,255,255,.4);opacity:0;transition:opacity .8s}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="ui">
<div id="topLabel">DAILY RITUAL</div>
<div id="title">Aura</div>
<div id="recal">RE-CALIBRATING</div>
<button id="btn">A C T I V A T E &nbsp; F I E L D</button>
<div id="status">Deep Recovery Active â€¢ M6 + M12 Locked</div>
</div>
<script>
const V=`attribute vec2 a_pos;void main(){gl_Position=vec4(a_pos,0,1);}`;
const F=`
precision highp float;
uniform float u_time;
uniform float u_tr;
uniform vec2 u_res;

vec3 mod289(vec3 x){return x-floor(x*(1./289.))*289.;}
vec2 mod289(vec2 x){return x-floor(x*(1./289.))*289.;}
vec3 permute(vec3 x){return mod289((x*34.+1.)*x);}
float snoise(vec2 v){
  const vec4 C=vec4(.211324865405187,.366025403784439,-.577350269189626,.024390243902439);
  vec2 i=floor(v+dot(v,C.yy)),x0=v-i+dot(i,C.xx),i1;
  i1=(x0.x>x0.y)?vec2(1,0):vec2(0,1);
  vec4 x12=x0.xyxy+C.xxzz;x12.xy-=i1;
  i=mod289(i);
  vec3 p=permute(permute(i.y+vec3(0,i1.y,1.))+i.x+vec3(0,i1.x,1.));
  vec3 m=max(.5-vec3(dot(x0,x0),dot(x12.xy,x12.xy),dot(x12.zw,x12.zw)),0.);
  m=m*m;m=m*m;
  vec3 x=2.*fract(p*C.www)-1.,h=abs(x)-.5,ox=floor(x+.5),a0=x-ox;
  m*=1.79284291400159-.85373472095314*(a0*a0+h*h);
  vec3 g;g.x=a0.x*x0.x+h.x*x0.y;g.yz=a0.yz*x12.xz+h.yz*x12.yw;
  return 130.*dot(m,g);
}
float fbm(vec2 p){
  float v=0.,a=.5;
  mat2 r=mat2(cos(.5),sin(.5),-sin(.5),cos(.5));
  for(int i=0;i<6;i++){v+=a*snoise(p);p=r*p*2.1;a*=.48;}
  return v;
}

void main(){
  vec2 uv=(gl_FragCoord.xy-.5*u_res)/min(u_res.x,u_res.y);
  float t=u_time;
  float tr=u_tr;
  float dist=length(uv);

  // Organic noise for blob edges
  float angle=atan(uv.y,uv.x);
  vec2 np=vec2(cos(angle),sin(angle))*2.5+t*.18;
  float n1=fbm(np+vec2(t*.12,t*.08));
  float n2=fbm(uv*3.2+vec2(t*.15,-t*.1));
  float n3=fbm(uv*5.5+vec2(-t*.08,t*.2));

  // Blob edge distortion - strong in initial, subtle in active
  float noiseAmp=mix(.1,.008,tr);
  float edgeNoise=n1*.6+n2*.3+n3*.1;
  float blobR=mix(.32,.36,tr)+edgeNoise*noiseAmp;

  // Breathing in active state
  float breathe=sin(t*.8)*.012*tr;
  blobR+=breathe;

  // Jagged flame tendrils for initial state
  float tendrilNoise=fbm(vec2(angle*2.5+t*.3,dist*4.+t*.2));
  float tendrils=tendrilNoise*mix(.08,0.,tr)*smoothstep(.5,.25,dist);

  // Shape with soft edge
  float edgeWidth=mix(.07,.03,tr);
  float shape=smoothstep(blobR+edgeWidth,blobR-edgeWidth*.5,dist-tendrils);

  // Colors - initial state
  vec3 tealCore=vec3(.05,.52,.46);
  vec3 darkMid=vec3(.08,.12,.12);
  vec3 redAura=vec3(.95,.15,.08);
  vec3 deepRed=vec3(.6,.05,.02);

  // Colors - active state
  vec3 whiteCore=vec3(.97,.95,.92);
  vec3 warmWhite=vec3(.92,.88,.82);
  vec3 goldRim=vec3(1.,.55,.15);
  vec3 softGold=vec3(.8,.4,.1);

  // Radial color mapping - initial
  float coreZone=smoothstep(.28,.0,dist);
  float midZone=smoothstep(.35,.15,dist);
  float auraZone=smoothstep(.45,.25,dist);

  vec3 initColor=mix(deepRed,redAura,auraZone);
  initColor=mix(initColor,darkMid,midZone);
  initColor=mix(initColor,tealCore,coreZone);

  // Add noise-based color variation to initial state
  float colorNoise=fbm(uv*4.+t*.1)*.15;
  initColor+=colorNoise*vec3(-.05,.08,.06)*midZone*(1.-tr);

  // Active color
  vec3 actColor=mix(softGold,goldRim,smoothstep(.4,.28,dist));
  actColor=mix(actColor,warmWhite,smoothstep(.32,.12,dist));
  actColor=mix(actColor,whiteCore,smoothstep(.2,.0,dist));

  // Bright center glow in active
  float centerGlow=exp(-dist*dist*18.)*tr;
  actColor+=vec3(.3,.28,.22)*centerGlow;

  vec3 color=mix(initColor,actColor,tr);

  // Outer glow/aura beyond the shape
  float outerGlow=smoothstep(.55,.2,dist)*smoothstep(blobR-.02,blobR+.15,dist);
  vec3 glowColor=mix(vec3(.8,.1,.05),vec3(.9,.5,.1),tr);
  float glowNoise=fbm(vec2(angle*3.+t*.2,t*.15))*.5+.5;
  outerGlow*=mix(glowNoise,.85,tr);

  // Flame-like outer tendrils for initial
  float flameDist=dist-blobR;
  float flames=0.;
  if(flameDist>0.&&flameDist<.2){
    float fn=fbm(vec2(angle*4.+t*.5,flameDist*15.-t*.8));
    flames=fn*smoothstep(.2,0.,flameDist)*(1.-tr)*.6;
  }

  // Combine
  float alpha=shape+outerGlow*.5+flames;
  alpha=clamp(alpha,0.,1.);
  vec3 finalColor=color*shape+glowColor*(outerGlow*.5+flames);

  // Stars
  vec2 starUV=gl_FragCoord.xy/u_res;
  float stars=0.;
  for(float i=0.;i<120.;i++){
    vec2 sp=vec2(fract(sin(i*127.1)*311.7),fract(sin(i*269.5)*183.3));
    float d=length(starUV-sp);
    float twinkle=sin(t*(.8+fract(sin(i*43.1)*191.9)*2.))*0.3+0.7;
    stars+=smoothstep(.0015,0.,d)*twinkle*.6;
  }
  finalColor+=vec3(stars)*(1.-alpha*.8);
  alpha=max(alpha,stars*.3);

  gl_FragColor=vec4(finalColor,1.);
}`;

const c=document.getElementById('c'),gl=c.getContext('webgl',{antialias:true,alpha:false});
function resize(){c.width=innerWidth*devicePixelRatio;c.height=innerHeight*devicePixelRatio;gl.viewport(0,0,c.width,c.height);}
resize();addEventListener('resize',resize);

function compile(t,s){const sh=gl.createShader(t);gl.shaderSource(sh,s);gl.compileShader(sh);if(!gl.getShaderParameter(sh,gl.COMPILE_STATUS))console.error(gl.getShaderInfoLog(sh));return sh;}
const pg=gl.createProgram();
gl.attachShader(pg,compile(gl.VERTEX_SHADER,V));
gl.attachShader(pg,compile(gl.FRAGMENT_SHADER,F));
gl.linkProgram(pg);gl.useProgram(pg);

const buf=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buf);
gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),gl.STATIC_DRAW);
const aPos=gl.getAttribLocation(pg,'a_pos');gl.enableVertexAttribArray(aPos);gl.vertexAttribPointer(aPos,2,gl.FLOAT,false,0,0);

const uTime=gl.getUniformLocation(pg,'u_time'),uTr=gl.getUniformLocation(pg,'u_tr'),uRes=gl.getUniformLocation(pg,'u_res');

let transition={v:0},state=0,audioCtx,g1,g2;
const btn=document.getElementById('btn'),statusEl=document.getElementById('status'),recalEl=document.getElementById('recal');

function startAudio(){
  if(audioCtx)return;
  audioCtx=new(window.AudioContext||window.webkitAudioContext)();
  const o1=audioCtx.createOscillator(),o2=audioCtx.createOscillator();
  g1=audioCtx.createGain();g2=audioCtx.createGain();
  o1.frequency.value=136.1;o2.frequency.value=272.2;
  o1.type='sine';o2.type='sine';
  g1.gain.value=0;g2.gain.value=0;
  o1.connect(g1).connect(audioCtx.destination);
  o2.connect(g2).connect(audioCtx.destination);
  o1.start();o2.start();
}

btn.addEventListener('click',()=>{
  startAudio();
  if(state===0){
    state=1;btn.textContent='S Y N C H R O N I Z I N G . . .';recalEl.style.opacity='0';
    gsap.to(transition,{v:1,duration:3.5,ease:'power2.inOut',onComplete:()=>{state=2;btn.textContent='D E A C T I V A T E   F I E L D';statusEl.style.opacity='1';}});
    g1.gain.linearRampToValueAtTime(.06,audioCtx.currentTime+2);
    g2.gain.linearRampToValueAtTime(.03,audioCtx.currentTime+2.5);
  }else if(state===2){
    state=3;btn.textContent='S Y N C H R O N I Z I N G . . .';statusEl.style.opacity='0';
    gsap.to(transition,{v:0,duration:3.5,ease:'power2.inOut',onComplete:()=>{state=0;btn.textContent='A C T I V A T E \u00a0 F I E L D';recalEl.style.opacity='1';}});
    g1.gain.linearRampToValueAtTime(0,audioCtx.currentTime+2);
    g2.gain.linearRampToValueAtTime(0,audioCtx.currentTime+2.5);
  }
});

function draw(t){
  gl.uniform1f(uTime,t*.001);
  gl.uniform1f(uTr,transition.v);
  gl.uniform2f(uRes,c.width,c.height);
  gl.drawArrays(gl.TRIANGLE_STRIP,0,4);
  requestAnimationFrame(draw);
}
requestAnimationFrame(draw);
</script>
</body>
</html>
