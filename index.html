<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<title>Aura — Daily Ritual</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#000;font-family:Georgia,'Times New Roman',serif}
canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0}
#ui{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none}
#subtitle{font-size:10px;letter-spacing:.4em;text-transform:uppercase;color:#777;margin-bottom:6px;font-weight:300}
#title{font-size:44px;font-weight:300;color:#fff;margin-bottom:0;font-family:Georgia,serif}
#centerLabel{position:absolute;font-size:13px;letter-spacing:.35em;text-transform:uppercase;color:rgba(255,255,255,.8);pointer-events:none}
#btn{pointer-events:all;cursor:pointer;border:none;outline:none;background:rgba(200,180,160,.3);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-radius:30px;padding:16px 40px;font-size:11px;letter-spacing:.3em;text-transform:uppercase;color:#999;font-family:Georgia,serif;min-height:48px;min-width:48px;position:absolute;transition:color .3s}
#btn:active{opacity:.8}
#statusText{position:absolute;bottom:0;font-size:11px;color:#c8a050;letter-spacing:.15em;opacity:0;text-align:center;padding:0 20px}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="ui">
<div id="subtitle">D A I L Y &nbsp; R I T U A L</div>
<div id="title">Aura</div>
<div id="centerLabel">R E - C A L I B R A T I N G</div>
<button id="btn">S Y N C H R O N I Z I N G . . .</button>
<div id="statusText">Deep Recovery Active • M6 + M12 Locked</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script>
const canvas=document.getElementById('c'),ctx=canvas.getContext('2d');
const centerLabel=document.getElementById('centerLabel'),btn=document.getElementById('btn'),statusText=document.getElementById('statusText');
let W,H,cx,cy,dpr;
let state=0; // 0=calibrating, 1=transitioning to active, 2=active, 3=transitioning to calibrating
let transition=0; // 0..1 interpolation
let transStart=0;
const TRANS_DUR=3500;

function resize(){
  dpr=Math.min(window.devicePixelRatio||1,2);
  W=window.innerWidth;H=window.innerHeight;
  canvas.width=W*dpr;canvas.height=H*dpr;
  canvas.style.width=W+'px';canvas.style.height=H+'px';
  ctx.setTransform(dpr,0,0,dpr,0,0);
  cx=W/2;cy=H/2;
  positionUI();
}

function positionUI(){
  const r=getRadius();
  centerLabel.style.top=(cy-8)+'px';
  centerLabel.style.left='50%';
  centerLabel.style.transform='translateX(-50%)';
  btn.style.left='50%';
  btn.style.transform='translateX(-50%)';
  statusText.style.left='50%';
  statusText.style.transform='translateX(-50%)';
  updateButtonPos();
}

function updateButtonPos(){
  const r=getRadius();
  const t=getT();
  // In state 1 (calibrating): button below blob. In active: inside lower orb area
  const belowY=cy+r*0.55+30;
  const insideY=cy+r*0.3;
  const btnY=lerp(belowY,insideY,t);
  btn.style.top=btnY+'px';
  statusText.style.bottom=(H-cy-r*0.55-60)+'px';
}

function getRadius(){
  const base=Math.min(W,H)*0.35;
  const active=Math.min(W,H)*0.39;
  return lerp(base,active,getT());
}

function getT(){
  if(state===0)return 0;
  if(state===2)return 1;
  if(state===1)return transition;
  if(state===3)return 1-transition;
  return 0;
}

function lerp(a,b,t){return a+(b-a)*t}
function clamp(v,a,b){return Math.max(a,Math.min(b,v))}

// Stars
const stars=[];
for(let i=0;i<130;i++){
  stars.push({
    x:Math.random(),y:Math.random(),
    size:Math.random()*2+0.5,
    twinkleSpeed:Math.random()*2+1,
    twinkleOffset:Math.random()*Math.PI*2,
    driftX:(Math.random()-.5)*.00003,
    driftY:(Math.random()-.5)*.00003,
    brightness:Math.random()*.5+.5
  });
}

function drawStars(time){
  for(const s of stars){
    s.x+=s.driftX;s.y+=s.driftY;
    if(s.x<0)s.x=1;if(s.x>1)s.x=0;
    if(s.y<0)s.y=1;if(s.y>1)s.y=0;
    const twinkle=.5+.5*Math.sin(time*s.twinkleSpeed+s.twinkleOffset);
    const a=s.brightness*(.4+.6*twinkle);
    ctx.fillStyle=`rgba(255,255,255,${a})`;
    ctx.beginPath();
    ctx.arc(s.x*W,s.y*H,s.size,0,Math.PI*2);
    ctx.fill();
  }
}

// Blob elements for state 0
const blobs=[];
for(let i=0;i<8;i++){
  blobs.push({
    angle:Math.PI*2*i/8,
    dist:.7+Math.random()*.3,
    rx:.45+Math.random()*.15,
    ry:.4+Math.random()*.15,
    phase:Math.random()*Math.PI*2,
    speed:.3+Math.random()*.4,
    rot:Math.random()*Math.PI
  });
}
const tealBlobs=[];
for(let i=0;i<4;i++){
  tealBlobs.push({
    angle:Math.PI*2*i/4,
    dist:.15+Math.random()*.1,
    rx:.3+Math.random()*.1,
    ry:.28+Math.random()*.1,
    phase:Math.random()*Math.PI*2,
    speed:.2+Math.random()*.3,
    rot:Math.random()*Math.PI
  });
}

// Surface dots for active orb
const surfaceDots=[];
for(let i=0;i<25;i++){
  surfaceDots.push({
    angle:Math.random()*Math.PI*2,
    dist:Math.random()*.85,
    size:Math.random()*1.5+.5,
    speed:.1+Math.random()*.2,
    phase:Math.random()*Math.PI*2
  });
}

function drawBlob(time,t,radius){
  // t=0: full blob, t=1: clean orb
  ctx.save();
  ctx.filter=`blur(${lerp(25,0,t)}px)`;
  
  // Red/coral outer blobs → orange/gold at t=1
  for(const b of blobs){
    const wobble=Math.sin(time*b.speed+b.phase);
    const wobble2=Math.cos(time*b.speed*.7+b.phase+1);
    const d=b.dist*radius*lerp(1,.01,t);
    const bx=cx+Math.cos(b.angle+wobble*.3)*d;
    const by=cy+Math.sin(b.angle+wobble2*.3)*d;
    const rx=b.rx*radius*lerp(1,.01,t);
    const ry=b.ry*radius*lerp(1,.01,t);
    
    // Color: red/coral → orange/gold
    const r=Math.round(lerp(255,255,t));
    const g=Math.round(lerp(40,153,t));
    const b2=Math.round(lerp(20,51,t));
    const alpha=lerp(.6,.0,t);
    
    ctx.fillStyle=`rgba(${r},${g},${b2},${alpha})`;
    ctx.beginPath();
    ctx.ellipse(bx,by,Math.max(1,rx),Math.max(1,ry),b.rot+wobble*.1,0,Math.PI*2);
    ctx.fill();
  }
  
  // Teal center blobs → white at t=1
  for(const b of tealBlobs){
    const wobble=Math.sin(time*b.speed+b.phase);
    const d=b.dist*radius*lerp(1,.02,t);
    const bx=cx+Math.cos(b.angle+wobble*.2)*d;
    const by=cy+Math.sin(b.angle+wobble*.2)*d;
    const rx=b.rx*radius*lerp(1,.02,t);
    const ry=b.ry*radius*lerp(1,.02,t);
    
    const r=Math.round(lerp(26,240,t));
    const g=Math.round(lerp(138,240,t));
    const b2=Math.round(lerp(122,245,t));
    const alpha=lerp(.7,.0,t);
    
    ctx.fillStyle=`rgba(${r},${g},${b2},${alpha})`;
    ctx.beginPath();
    ctx.ellipse(bx,by,Math.max(1,rx),Math.max(1,ry),b.rot,0,Math.PI*2);
    ctx.fill();
  }
  ctx.filter='none';
  ctx.restore();
}

function drawOrb(time,t,radius){
  if(t<=0)return;
  const breath=1+Math.sin(time*.8)*.03*t;
  const r=radius*breath;
  
  ctx.save();
  // Outer gold/orange corona
  const outerGrad=ctx.createRadialGradient(cx,cy,r*.7,cx,cy,r*1.4);
  outerGrad.addColorStop(0,'rgba(255,180,80,0)');
  outerGrad.addColorStop(.5,`rgba(255,153,51,${.35*t})`);
  outerGrad.addColorStop(.7,`rgba(255,120,30,${.2*t})`);
  outerGrad.addColorStop(1,'rgba(255,100,20,0)');
  ctx.fillStyle=outerGrad;
  ctx.beginPath();ctx.arc(cx,cy,r*1.4,0,Math.PI*2);ctx.fill();
  
  // Second corona layer
  const corona2=ctx.createRadialGradient(cx,cy,r*.8,cx,cy,r*1.15);
  corona2.addColorStop(0,'rgba(255,220,180,0)');
  corona2.addColorStop(.6,`rgba(255,200,140,${.3*t})`);
  corona2.addColorStop(1,'rgba(255,160,80,0)');
  ctx.fillStyle=corona2;
  ctx.beginPath();ctx.arc(cx,cy,r*1.15,0,Math.PI*2);ctx.fill();
  
  // Main orb body
  const mainGrad=ctx.createRadialGradient(cx-r*.1,cy-r*.1,0,cx,cy,r);
  mainGrad.addColorStop(0,`rgba(255,255,255,${t})`);
  mainGrad.addColorStop(.3,`rgba(240,238,235,${t*.95})`);
  mainGrad.addColorStop(.7,`rgba(220,210,200,${t*.8})`);
  mainGrad.addColorStop(.9,`rgba(200,180,150,${t*.5})`);
  mainGrad.addColorStop(1,`rgba(180,150,100,0)`);
  ctx.fillStyle=mainGrad;
  ctx.beginPath();ctx.arc(cx,cy,r,0,Math.PI*2);ctx.fill();
  
  // Pearl highlight
  const hlGrad=ctx.createRadialGradient(cx-r*.2,cy-r*.25,0,cx-r*.15,cy-r*.2,r*.4);
  hlGrad.addColorStop(0,`rgba(255,255,255,${.7*t})`);
  hlGrad.addColorStop(1,'rgba(255,255,255,0)');
  ctx.fillStyle=hlGrad;
  ctx.beginPath();ctx.arc(cx-r*.15,cy-r*.2,r*.4,0,Math.PI*2);ctx.fill();
  
  // Surface dots
  for(const d of surfaceDots){
    const a=d.angle+time*d.speed;
    const dd=d.dist*r;
    const dx=cx+Math.cos(a)*dd;
    const dy=cy+Math.sin(a)*dd;
    ctx.fillStyle=`rgba(255,255,255,${.4*t})`;
    ctx.beginPath();ctx.arc(dx,dy,d.size,0,Math.PI*2);ctx.fill();
  }
  ctx.restore();
}

// Audio
let audioCtx,osc1,osc2,gainNode;
function startAudio(){
  if(audioCtx)return;
  audioCtx=new(window.AudioContext||window.webkitAudioContext)();
  gainNode=audioCtx.createGain();
  gainNode.gain.value=0;
  gainNode.connect(audioCtx.destination);
  osc1=audioCtx.createOscillator();osc1.type='sine';osc1.frequency.value=136.1;
  osc2=audioCtx.createOscillator();osc2.type='sine';osc2.frequency.value=272.2;
  const g2=audioCtx.createGain();g2.gain.value=.3;
  osc1.connect(gainNode);osc2.connect(g2);g2.connect(gainNode);
  osc1.start();osc2.start();
}
function fadeAudioIn(){startAudio();gainNode.gain.cancelScheduledValues(audioCtx.currentTime);gainNode.gain.linearRampToValueAtTime(.12,audioCtx.currentTime+3)}
function fadeAudioOut(){if(!audioCtx)return;gainNode.gain.cancelScheduledValues(audioCtx.currentTime);gainNode.gain.linearRampToValueAtTime(0,audioCtx.currentTime+3)}

// State machine
btn.addEventListener('click',()=>{
  if(state===0){
    state=1;transition=0;transStart=performance.now();
    fadeAudioIn();
    gsap.to(centerLabel,{opacity:0,duration:1});
    btn.textContent='A C T I V A T I N G . . .';
    btn.style.color='#cba050';
  }else if(state===2){
    state=3;transition=0;transStart=performance.now();
    fadeAudioOut();
    gsap.to(statusText,{opacity:0,duration:1});
    btn.textContent='D E A C T I V A T I N G . . .';
  }
});

function frame(now){
  const time=now*.001;
  
  // Update transition
  if(state===1||state===3){
    transition=clamp((now-transStart)/TRANS_DUR,0,1);
    if(transition>=1){
      if(state===1){
        state=2;
        btn.textContent='D E A C T I V A T E   F I E L D';
        btn.style.color='#bbb';
        gsap.to(statusText,{opacity:1,duration:1.5});
      }else{
        state=0;
        centerLabel.style.opacity='1';
        btn.textContent='S Y N C H R O N I Z I N G . . .';
        btn.style.color='#999';
      }
    }
  }
  
  const t=getT();
  const radius=getRadius();
  updateButtonPos();
  
  ctx.clearRect(0,0,W,H);
  drawStars(time);
  drawBlob(time,t,radius);
  drawOrb(time,t,radius);
  
  requestAnimationFrame(frame);
}

window.addEventListener('resize',resize);
resize();
requestAnimationFrame(frame);
</script>
</body>
</html>
